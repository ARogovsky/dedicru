<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Наследие &#8212; DEDIC.RU: наследие об организации хостинга</title>
	<atom:link href="http://dedic.ru/category/%d0%bd%d0%b0%d1%81%d0%bb%d0%b5%d0%b4%d0%b8%d0%b5/feed/" rel="self" type="application/rss+xml" />
	<link>http://dedic.ru/</link>
	<description>Мемуары о системном администрировании хостинга выделенных серверов</description>
	<lastBuildDate>Sat, 13 Jun 2020 15:12:33 +0000</lastBuildDate>
	<language>ru-RU</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.4.2</generator>

<image>
	<url>http://dedic.ru/wp-content/uploads/2020/06/cropped-16b3d258-b9f4-4c6b-8f06-9dd027ad4f8e_200x200-32x32.png</url>
	<title>Наследие &#8212; DEDIC.RU: наследие об организации хостинга</title>
	<link>http://dedic.ru/</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>Хайлоад: Типичные ошибки клиентов</title>
		<link>http://dedic.ru/%d1%85%d0%b0%d0%b9%d0%bb%d0%be%d0%b0%d0%b4-%d1%82%d0%b8%d0%bf%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b8-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d0%be%d0%b2/</link>
					<comments>http://dedic.ru/%d1%85%d0%b0%d0%b9%d0%bb%d0%be%d0%b0%d0%b4-%d1%82%d0%b8%d0%bf%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b8-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d0%be%d0%b2/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Sat, 20 Aug 2011 13:24:45 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d1%85%d0%b0%d0%b9%d0%bb%d0%be%d0%b0%d0%b4-%d1%82%d0%b8%d0%bf%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b8-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d0%be%d0%b2/</guid>

					<description><![CDATA[Все проблемы в хайлоаде носят довольно четко выраженный характер, и я хочу попробовать их классифицировать.
<h3>Мода важнее здравого смысла</h3>
Процитирую диалог с одним из клиентов:
<i>
- Сколько стоит поставить nginx?
- Зависит от задачи, а в чем она состоит?
- У меня сайт медленно работает, и я слышал, что nginx позволяет его ускорить!
- Я вижу по анализатору, что на сайте более 200 изображений, а нагрузка на сервер при этом 2-3%. Проблема не в сервере, а в том, что слишком много изображений, на погрузку которых браузер тратит свои ресурсы.
- А разве nginx не ускорит их отдачу?
- Ускорит, но проблема не в скорости их загрузки, а в большом числе.
- Что же делать?
- Переписать дизайн, и вынести картинки подгрузкой в css.
- Это слишком долго, я хочу nginx и готов заплатить.
- Хорошо, но предупреждаю - это не сильно повлияет на скорость загрузки сайта.
</i>
В результате, после установки nginx, клиент был вынужден обратиться к услугам профессионального верстальщика, который сократил его 200+ изображений до 83-х, вынеся все повторяющиеся элементы в css.
Его проблема была не в том, что он не понимал как пагубно влияет такое число изображений на скорость открытия страницы, а безумное следование моды: <b>медленно работает - ставь nginx!</b>
]]></description>
										<content:encoded><![CDATA[<p>Все проблемы в хайлоаде носят довольно четко выраженный характер, и я хочу попробовать их классифицировать.</p>
<h3>Мода важнее здравого смысла</h3>
<p>Процитирую диалог с одним из клиентов:<br />
<i><br />
&#8212; Сколько стоит поставить nginx?<br />
&#8212; Зависит от задачи, а в чем она состоит?<br />
&#8212; У меня сайт медленно работает, и я слышал, что nginx позволяет его ускорить!<br />
&#8212; Я вижу по анализатору, что на сайте более 200 изображений, а нагрузка на сервер при этом 2-3%. Проблема не в сервере, а в том, что слишком много изображений, на погрузку которых браузер тратит свои ресурсы.<br />
&#8212; А разве nginx не ускорит их отдачу?<br />
&#8212; Ускорит, но проблема не в скорости их загрузки, а в большом числе.<br />
&#8212; Что же делать?<br />
&#8212; Переписать дизайн, и вынести картинки подгрузкой в css.<br />
&#8212; Это слишком долго, я хочу nginx и готов заплатить.<br />
&#8212; Хорошо, но предупреждаю &#8212; это не сильно повлияет на скорость загрузки сайта.<br />
</i><br />
В результате, после установки nginx, клиент был вынужден обратиться к услугам профессионального верстальщика, который сократил его 200+ изображений до 83-х, вынеся все повторяющиеся элементы в css.<br />
Его проблема была не в том, что он не понимал как пагубно влияет такое число изображений на скорость открытия страницы, а безумное следование моды: <b>медленно работает &#8212; ставь nginx!</b><br />
<!--break--></p>
<h3>Гадание вместо статистики</h3>
<p>Процитирую диалог с одним из клиентов:<br />
<i><br />
&#8212; Мне надо настроить MySQL!<br />
&#8212; А что с ним такое?<br />
&#8212; У меня клиенты на хостинге жалуются, что их сайты тормозят!<br />
&#8212; Но я вижу, что mysql потребляет 2-5% RAM и 15-20% CPU. И нагрузки никакой нет, все запросы успешно попадают в кеш.<br />
&#8212; Тогда надо поставить xcache для php, выдав ему больше памяти, потому что скорость открытия сайтов ну очень низкая!<br />
&#8212; Я могу поставить, только не гарантирую, что это поможет.<br />
&#8212; А что же делать?<br />
&#8212; Заказать у меня аудит сервера, по результатам которого работать над найденными проблемами.<br />
&#8212; Хорошо, заказываю.<br />
</i><br />
По результатам анализа, проблема оказалась в медленном выполнении кода SAPE, причиной которого стала медленная работа DNS ресловеров, предоставленных Дата-Центром: из 3-х работал только один, да и то с большими задержками.<br />
Проблема решилась прописыванием DNS ресловера Goole 8.8.8.8 и 8.8.4.4</p>
<h3>Наличие практического опыта без фундаментальных знаний</h3>
<p>Эта проблема более актуальна для начинающих системных администраторов, которые случайно найдя решение какой-то проблемы, пытаются ее применять в похожих случаях, но без понимания источника этой проблемы.<br />
<i><br />
&#8212; Мне нужен аудит двух серверов, почему на одном сервере InnoDB работает правильно, а на другом &#8212; нет.<br />
&#8212; А что значит правильно? Задачи у серверов одинаковые?<br />
&#8212; На одном сервере после переноса базы в InnoDB, сайт стал открываться быстрее. А на другом сервере &#8212; нет.<br />
&#8212; Хорошо, разберусь.<br />
</i><br />
На одном сервере сайт был на CMS Drupal, который умеет использовать InnoDB и имеет собственные схемы кеширования. Проблем никаких не возникало.<br />
На другом сервере сайт был на CMS DLE, в запросах постоянно был select count с последующими множеством update. Так как CMS была лицензионная, примеры таких запросов были отправлены разработчику, который рекомендовал отключить счетчики страниц. После чего проблема пропала.<br />
Провести сравнение запросов на серверах клиенту и в голову не приходило, он занимался тем, что постоянно менял параметры в конфиге mysql, в надежде, что станет быстрее работать.</p>
<h3>Неумение разделять задачи</h3>
<p>Один очень крупный заказчик, занимающийся стримингом и имеющий сайт, входящий в top-3 одной из узких ниш, пожаловался, что возникла проблема с конвертацией видео.<br />
Сервер, который занимался конвертацией был очень мощный, но уже не смог обрабатывать все поступающие видео от пользователей с должной скоростью.<br />
Мне нужно было произвести анализ, какой сервер лучше выбрать из ряда предложений дата-центра.<br />
Как оказалось, конветрация более всего использовала ресурсы процессора и диска, в меньшей степени &#8212; оперативной памяти, которая пустовала на 90%.<br />
Я предложил ему вместо перехода на новый сервер, взять 4-е более слабые модели, которые по цене выходили дешевле.<br />
<i><br />
&#8212; Нет, мне это не подойдет. Я буду конвертировать 4-е разных файла от пользователей, но конвертация все равно будет медленной, я уже это пробовал! Мне нужно один, но быстро!<br />
&#8212; Так я для этого и советую взять 4-е сервера. Разделить видео на 4-е части, затем каждую часть сконвертировать на своем сервере. После чего склеить.<br />
&#8212; А разве так можно?!<br />
&#8212; Нужно.<br />
</i><br />
Разумеется, что конвертация прошла очень быстро, но главное &#8212; теперь клиент четко знает, сколько именно ему нужно докупить серверов, для того, чтоб скорость конвертации оставалась на должном уровне.</p>
<h3>Отсутствие кеширования</h3>
<p><i><br />
&#8212; У меня большая нагрузка на MySQL. Посоветовали memcache! Я поставил &#8212; не помогло!<br />
&#8212; В смысле &#8212; поставил?<br />
&#8212; Ну сделал apt-get install memcached php5-memcache и рестартовал апач.<br />
&#8212; И все?<br />
&#8212; Да! А разве еще что-то надо?<br />
</i><br />
Множество людей тратит невероятно большие деньги на покупку мощных серверов. И все это из-за недостаточности понимания того, что же такое на самом деле является кеширование.<br />
В качестве примера, я приведу решение проблемы на биржевой системе.<br />
Сервера постоянно получают информацию по стоимости акций, клиенты просматривают графики, покупают-продают, вобщем как обычно.<br />
При этом используется черезвычайно мощный сервер и программисты уверяют, что действительно оптимизировали все что могли, и проблема в недостатке железа. Но владелец проекта приводит другую статистику &#8212; с ростом каждой тысячи активных пользователей приходится брать вдвое мощный сервер. Сейчас их 4000 и если рост будет идти также быстро как и сейчас, то в скором времени придется переезжать на суперкомпьютер.<br />
Аудит шел достаточно долго &#8212; на первый взгляд действительно, все было кешировано:</p>
<ul>
<li>повторяющиеся запросы складывались в memcache</li>
<li>был установлен и настроен xcache, который хранил все php скрипты в оперативной памяти</li>
<li>все статичные файлы выдавались с правильным заголовком expired</li>
</ul>
<p>А затем я нашел директорию, в которой были сотни тысяч файлов. На ее открытие уходило несколько секунд.<br />
Дословно процитирую диалог:<br />
&#8212; Это графики пользователей, которые они хотят получать. Там можно накладывать несколько графиков в один. У каждого пользователя &#8212; свои графики.<br />
&#8212; А сколько всего акций и сколько всего пользователей?<br />
&#8212; Примерно 400 акций и около 60000 пользователей.<br />
&#8212; А если выдавать графики для каждой акции, а потом просто склеивать картинки в одну общую?<br />
&#8212; Уже так думали делать, но будет большая нагрузка на диск &#8212; их все равно придется записывать перед отдачей.<br />
&#8212; А зачем? Пусть они собираются на стороне клиента.<br />
&#8212; Но как???<br />
&#8212; При помощи javascript.<br />
&#8212; Склеивать картинки через javascript на стороне клиента?<br />
&#8212; Нет. Выдавать цифры, с помощью которых ajax будет рисовать графики, а цифры отдавать через push с помощью&#8230;<br />
&#8212; Спасибо, уже не надо продолжать, поняли свою ошибку.<br />
Кеширование &#8212; это не просто сохранение картинок на диске, это немного нечто большее&#8230;</p>
<h3>Попытка масштабировать без понимания сути проблемы</h3>
<p><i><br />
&#8212; У нас есть сайт, с помощью которого пользователи могут размещать рекламу на страницах своих сайтов. Все бы ничего, но похоже, что надо разделять базу на множество серверов, так как она довольно часто тормозит и реклама не отображается.<br />
&#8212; А вы пробовали найти причину тормозов и воспроизвести их?<br />
&#8212; Нет, а разве это надо? По этому и надо масштабирование, чтоб не заморачиваться.<br />
</i><br />
Не буду томить, мне удалось убедить заказчика вначале заказать аудит сервера на предмет подобных тормозов.<br />
Причина частых торможений заключалась в том, что биллинг вызывался по крону каждую минуту и для пересчета зачем-то лочил все таблицы.<br />
Как выяснилось, это было сделано для того, чтоб клиенты не выполняли никаких действий на момент отсчета биллинга.<br />
Мной было предложено решение в виде сохранения заказов в отдельную таблицу, которые будут вливаться в общую базу данных при помощи того-же скрипта биллинга.<br />
Владелец согласился, так как задержка в обработке заказа была не более минуты, а это не так критично как покупка серверов для масштабирования, которое кстати бы не спасло от этой проблемы.</p>
<h3>Наличие единой точки отказа</h3>
<p>Компания, поставлявшая услуги хостинга картинок, решила подумать о защите от DDOS атак. Не смотря на многочисленные доводы о том, что лучшая защита от DDOS &#8212; это кластер грамотно настроенных серверов с фильтрацией, технический директор компании решил использовать Cisco RiverGuard для защиты.<br />
Шло время, одного сервера стало недостаточно, и незаметно их число возросло до шестидесяти. Сервера закупались, ставились в стойки, но весь трафик продолжал идти через циску.<br />
А потом наступила проблема &#8212; трафик перестал расти. Раньше, с ростом числа серверов трафик рос пропорционально, но сейчас перестал.<br />
Я снял статистику с циски по snmp и убедился, что эта железка испытывает явные проблемы с перегрузками. Техдиректор сразу решил, что началась DDOS атака.<br />
Однако по анализу логов все было чисто. Проблема была явно в перегрузке точки, через которую шел трафик.<br />
Тем не менее, владельца бизнеса это не убедило, так как технический директор мотивировал тем, что &#171;Cisco &#8212; это сила, а частный консультант &#8212; это обычный человек&#187;.<br />
Проблема продолжалась в течении года, пока наконец под моими многочисленными уговорами, технический директор не отправил кейс с графиками загрузки.<br />
Ответ пришел достаточно быстро, в котором однозначно указывалось, что этот девайс перестанет нормально работать, если число одновременных запросов будет выше 70k.<br />
После этого владелец наконец рискнул убрать Guard с канала, напрямую дав его на все стойки. Разумеется, трафик начал расти.<br />
Однако тот, кто прочитав, подумает, что единая точка отказа это Cisco RiverGuard, тот ошибется. Разумеется, единой точной отказа был технический директор.</p>
<h3>Белогривые лошадки</h3>
<p><i>У нас есть игра для социальной сети Вконтакте. Мы хотим сделать версию для Facebook, но боимся, что сервер не выдержит. По этому мы перешли на облако, а кластер для нас это слишком дорого для начала. Но потом, когда мы заработаем, то обязательно перейдем на кластер.</i><br />
Когда у вас появляется кластер, то вы все равно будете иметь некий лимит ресурсов, определяемый числом серверов в кластере.<br />
Облако напротив &#8212; дает мифическую свободу ресурсов, позволяя на какой-то момент не задумываться, а просто оплачивать перерасход ресурсов, в надежде, что прибыль окупит затраты.<br />
Коварство заключается в том, что рост нагрузки не связан линейно с ростом посещаемости и целиком зависит от радиуса кривизны приложения. Наверное каждый слышал притчу о награде изобретателя шахмат?<br />
На первую клетку шахматной доски &#8212; одно зернышко, на второе &#8212; два, и так далее.<br />
Так и с облаками. На первую тысячу посетителей &#8212; один слот, на вторую &#8212; два, на третью &#8212; четыре. А вот когда их становится пять, то внезапно(!) приходит озарение, что следующую тысячу &#171;мы не потянем&#187;, полученных денег едва хватает чтоб оплатить за облако, а на оптимизацию кривого движка игры уже совсем ничего не осталось.</p>
<h3>Заключение</h3>
<p>Конечно, я перечислил далеко не все типичные проблемы в хайлоаде. На это у меня не хватает ни сил, не желания. Но надеюсь, что после прочтения вы сможете избежать наиболее распространенных ошибок.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d1%85%d0%b0%d0%b9%d0%bb%d0%be%d0%b0%d0%b4-%d1%82%d0%b8%d0%bf%d0%b8%d1%87%d0%bd%d1%8b%d0%b5-%d0%be%d1%88%d0%b8%d0%b1%d0%ba%d0%b8-%d0%ba%d0%bb%d0%b8%d0%b5%d0%bd%d1%82%d0%be%d0%b2/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Расширяем лог почтового сервера</title>
		<link>http://dedic.ru/%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d1%8f%d0%b5%d0%bc-%d0%bb%d0%be%d0%b3-%d0%bf%d0%be%d1%87%d1%82%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0/</link>
					<comments>http://dedic.ru/%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d1%8f%d0%b5%d0%bc-%d0%bb%d0%be%d0%b3-%d0%bf%d0%be%d1%87%d1%82%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Fri, 12 Aug 2011 01:18:54 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d1%8f%d0%b5%d0%bc-%d0%bb%d0%be%d0%b3-%d0%bf%d0%be%d1%87%d1%82%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0/</guid>

					<description><![CDATA[Вам хотелось бы знать, с какого сайта и каким скриптом было отправлено то или иное письмо? Думаю, что да.
Однако стандартный почтовый сервер такой информации не ведет.

Так исправим этот недостаток!
]]></description>
										<content:encoded><![CDATA[<p>Вам хотелось бы знать, с какого сайта и каким скриптом было отправлено то или иное письмо? Думаю, что да.<br />
Однако стандартный почтовый сервер такой информации не ведет.</p>
<p>Так исправим этот недостаток!<br />
<!--break--></p>
<pre>
cd /usr/sbin
mv sendmail sendmail.org
vi sendmail
</pre>
<p>И напишем небольшой скрипт:</p>
<pre>
#!/bin/sh
logger -p mail.info sendmail-ext-log: site=${HTTP_HOST}, client=${REMOTE_ADDR}, script=${SCRIPT_NAME}, pwd=${PWD}, uid=${UID}, user=$(whoami)
/usr/sbin/sendmail.org -t -i $*
</pre>
<p>После чего сделаем файл исполняемым:</p>
<pre>
chmod +x sendmail
</pre>
<p>Все. Теперь лог будет иметь всю необходимую информацию.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d1%80%d0%b0%d1%81%d1%88%d0%b8%d1%80%d1%8f%d0%b5%d0%bc-%d0%bb%d0%be%d0%b3-%d0%bf%d0%be%d1%87%d1%82%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Быстрое восстановление аккаунтво cpanel</title>
		<link>http://dedic.ru/%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d0%b2%d0%be%d1%81%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%ba%d0%ba%d0%b0%d1%83%d0%bd%d1%82%d0%b2%d0%be-cpanel/</link>
					<comments>http://dedic.ru/%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d0%b2%d0%be%d1%81%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%ba%d0%ba%d0%b0%d1%83%d0%bd%d1%82%d0%b2%d0%be-cpanel/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Fri, 26 Jan 2007 06:40:12 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d0%b2%d0%be%d1%81%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%ba%d0%ba%d0%b0%d1%83%d0%bd%d1%82%d0%b2%d0%be-cpanel/</guid>

					<description><![CDATA[Предположим, что в /home находится множество резеврных копий акканутов в формате cpanel и их необходимо максимально бытро восстановить

Для этого используем следующий скрипт:
for i in `ls cpmove-*.tar.gz`; do a=`basename $i .tar.gz`; /scripts/restorepkg  `echo $a &#124; cut -d -  -f2`; done]]></description>
										<content:encoded><![CDATA[<p>Предположим, что в /home находится множество резеврных копий акканутов в формате cpanel и их необходимо максимально бытро восстановить</p>
<p>Для этого используем следующий скрипт:<br />
for i in `ls cpmove-*.tar.gz`; do a=`basename $i .tar.gz`; /scripts/restorepkg  `echo $a | cut -d &#8212;  -f2`; done</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d0%b1%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d0%b2%d0%be%d1%81%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b0%d0%ba%d0%ba%d0%b0%d1%83%d0%bd%d1%82%d0%b2%d0%be-cpanel/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Смена кодировки у базы и всех ее таблиц из командой строки</title>
		<link>http://dedic.ru/%d1%81%d0%bc%d0%b5%d0%bd%d0%b0-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d1%83-%d0%b1%d0%b0%d0%b7%d1%8b-%d0%b8-%d0%b2%d1%81%d0%b5%d1%85-%d0%b5%d0%b5-%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86/</link>
					<comments>http://dedic.ru/%d1%81%d0%bc%d0%b5%d0%bd%d0%b0-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d1%83-%d0%b1%d0%b0%d0%b7%d1%8b-%d0%b8-%d0%b2%d1%81%d0%b5%d1%85-%d0%b5%d0%b5-%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Sat, 13 Jan 2007 09:02:25 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d1%81%d0%bc%d0%b5%d0%bd%d0%b0-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d1%83-%d0%b1%d0%b0%d0%b7%d1%8b-%d0%b8-%d0%b2%d1%81%d0%b5%d1%85-%d0%b5%d0%b5-%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86/</guid>

					<description><![CDATA[Предположим у нас есть база mydb, в неверной кодировке (latin1) по умолчанию. Необходимо выставить ее в utf8. для этого используем скрипт:

echo "ALTER DATABASE mydb DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;" &#124; mysql; for i in `mysqlshow mydb % &#124; grep -v + &#124; cut -d ' ' -f2;`; do echo "ALTER TABLE mydb.$i DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;" &#124; mysql  ; done]]></description>
										<content:encoded><![CDATA[<p>Предположим у нас есть база mydb, в неверной кодировке (latin1) по умолчанию. Необходимо выставить ее в utf8. для этого используем скрипт:</p>
<p>echo &#171;ALTER DATABASE mydb DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;&#187; | mysql; for i in `mysqlshow mydb % | grep -v + | cut -d &#8216; &#8216; -f2;`; do echo &#171;ALTER TABLE mydb.$i DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;&#187; | mysql  ; done</p>
<p>В скрипте mydb замените на название своей БД.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d1%81%d0%bc%d0%b5%d0%bd%d0%b0-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d1%83-%d0%b1%d0%b0%d0%b7%d1%8b-%d0%b8-%d0%b2%d1%81%d0%b5%d1%85-%d0%b5%d0%b5-%d1%82%d0%b0%d0%b1%d0%bb%d0%b8%d1%86/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Оптимизируем VDS под файл-хостинг с использованием nginx</title>
		<link>http://dedic.ru/%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b8%d1%80%d1%83%d0%b5%d0%bc-vds-%d0%bf%d0%be%d0%b4-%d1%84%d0%b0%d0%b9%d0%bb-%d1%85%d0%be%d1%81%d1%82%d0%b8%d0%bd%d0%b3-%d1%81-%d0%b8%d1%81%d0%bf%d0%be/</link>
					<comments>http://dedic.ru/%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b8%d1%80%d1%83%d0%b5%d0%bc-vds-%d0%bf%d0%be%d0%b4-%d1%84%d0%b0%d0%b9%d0%bb-%d1%85%d0%be%d1%81%d1%82%d0%b8%d0%bd%d0%b3-%d1%81-%d0%b8%d1%81%d0%bf%d0%be/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Thu, 16 Nov 2006 14:21:32 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b8%d1%80%d1%83%d0%b5%d0%bc-vds-%d0%bf%d0%be%d0%b4-%d1%84%d0%b0%d0%b9%d0%bb-%d1%85%d0%be%d1%81%d1%82%d0%b8%d0%bd%d0%b3-%d1%81-%d0%b8%d1%81%d0%bf%d0%be/</guid>

					<description><![CDATA[Если использовать VDS в стандартной поставке с веб-сервером apache, то рано или поздно возникнет проблема с недостатком памяти. И это вполне логично:

Каждый из потомков апача отнимает достаточно много памяти

При отдаче медиаконетнта и просто файлов больших размеров 
возникают медленные коннекты и число потомков неумолимо растет

Для исправления подобной ситуации можно использовать легкий 
вебсервер nginx

В качестве примера возьмем VDS с Fedora Core 2 от keyweb, где традиционно не стоит yum и проведем установку и конфигурацию nginx:
]]></description>
										<content:encoded><![CDATA[<p>Если использовать VDS в стандартной поставке с веб-сервером apache, то рано или поздно возникнет проблема с недостатком памяти. И это вполне логично:</p>
<p>Каждый из потомков апача отнимает достаточно много памяти</p>
<p>При отдаче медиаконетнта и просто файлов больших размеров<br />
возникают медленные коннекты и число потомков неумолимо растет</p>
<p>Для исправления подобной ситуации можно использовать легкий<br />
вебсервер nginx</p>
<p>В качестве примера возьмем VDS с Fedora Core 2 от keyweb, где традиционно не стоит yum и проведем установку и конфигурацию nginx:<br />
<!--break--></p>
<p><code><br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/gcc-3.3.3-7.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/pcre-devel-4.5-2.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/binutils-2.15.90.0.3-5.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/cpp-3.3.3-7.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/glibc-devel-2.3.3-27.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/glibc-headers-2.3.3-27.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/glibc-kernheaders-2.4-8.44.i386.rpm<br />
wget http://download.fedora.redhat.com/pub/fedora/linux/core/2/i386/os/Fedora/RPMS/pcre-4.5-2.i386.rpm<br />
rpm -Uvh *.rpm<br />
wget http://sysoev.ru/nginx/nginx-0.4.13.tar.gz<br />
tar xzf 0.4.13.tar.gz<br />
cd nginx-0.4.13<br />
./configure --prefix=/usr/local/nginx --without-http_charset_module --without-http_ssi_module --without-http_userid_module --without-http_access_module --without-http_auth_basic_module --without-http_empty_gif_module --without-http_gzip_module --without-http_rewrite_module --without-pcre<br />
make -s<br />
make install<br />
</code><br />
После чего nginx будет установлен в /usr/local/nginx в минимальной рабочей конфигурации (а значит &#8212; максимально быстрый)<br />
Далее следует сконфигурировать его на отдачу файлов по протоколу http. Пример конфигурации nginx.conf:<br />
<code><br />
worker_processes    1;<br />
events {<br />
worker_connections  1024;<br />
}</code></p>
<p><code><code></code></code></p>
<p>http {<br />
include conf/mime.types;<br />
default_type application/octet-stream;</p>
<p><code><code></code></code></p>
<p>log_format main &#8216;$remote_addr &#8212; $remote_user [$time_local] $status &#8216;<br />
&#8216;&#187;$request&#187; $body_bytes_sent &#171;$http_referer&#187; &#8216;<br />
&#8216;&#187;$http_user_agent&#187; &#171;$http_x_forwarded_for&#187;&#8216;;</p>
<p><code><code></code></code></p>
<p>access_log /dev/null;</p>
<p><code><code></code></code></p>
<p>tcp_nopush on;<br />
keepalive_timeout 15;</p>
<p><code><br />
</code></p>
<p><code>    server {<br />
listen      ваш_ip:80;<br />
root        /home/download;<br />
}<br />
}<br />
</code><br />
Листинг директорий и логи отключены, первое &#8212; по техзаданию, а второе &#8212; для ускорения работы (запись логов на диск требует времени).</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d0%be%d0%bf%d1%82%d0%b8%d0%bc%d0%b8%d0%b7%d0%b8%d1%80%d1%83%d0%b5%d0%bc-vds-%d0%bf%d0%be%d0%b4-%d1%84%d0%b0%d0%b9%d0%bb-%d1%85%d0%be%d1%81%d1%82%d0%b8%d0%bd%d0%b3-%d1%81-%d0%b8%d1%81%d0%bf%d0%be/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Исправляем погрешности в DNS зонах</title>
		<link>http://dedic.ru/%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d1%8f%d0%b5%d0%bc-%d0%bf%d0%be%d0%b3%d1%80%d0%b5%d1%88%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b2-dns-%d0%b7%d0%be%d0%bd%d0%b0%d1%85/</link>
					<comments>http://dedic.ru/%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d1%8f%d0%b5%d0%bc-%d0%bf%d0%be%d0%b3%d1%80%d0%b5%d1%88%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b2-dns-%d0%b7%d0%be%d0%bd%d0%b0%d1%85/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Thu, 16 Nov 2006 09:52:52 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d1%8f%d0%b5%d0%bc-%d0%bf%d0%be%d0%b3%d1%80%d0%b5%d1%88%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b2-dns-%d0%b7%d0%be%d0%bd%d0%b0%d1%85/</guid>

					<description><![CDATA[На одном из серверов под управлением ISP System был обнаружен досадный сбой - панель создала файлы зон, где для субдомена WWW был указан некорректный IP. В результате сайты без www открывались нормально, а с www - нет.
Для исправления этой проблемы было использовано:
]]></description>
										<content:encoded><![CDATA[<p>На одном из серверов под управлением ISP System был обнаружен досадный сбой &#8212; панель создала файлы зон, где для субдомена WWW был указан некорректный IP. В результате сайты без www открывались нормально, а с www &#8212; нет.<br />
Для исправления этой проблемы было использовано:<br />
<!--break--><br />
[adsense:336&#215;280:1:1]<br />
1. Замена некорректных IP адресов в доменных зонах при помощи perl: <code>perl -pi.bak -e "s/WRONGIP/CORRECTIP/g" /var/named/*.db</code>, где WRONGIP &#8212; неправильный IP, а CORRECTIP &#8212; соответственно правильный.<br />
2. После исправления всех IP был увеличин serail доменных зон при помощи достаточно известного скрипта zsu.</p>
<p>После проведения этих действий сайты стали откываться корректно. http://forum.searchengines.ru/showthread.php?p=1627459</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d0%b8%d1%81%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d1%8f%d0%b5%d0%bc-%d0%bf%d0%be%d0%b3%d1%80%d0%b5%d1%88%d0%bd%d0%be%d1%81%d1%82%d0%b8-%d0%b2-dns-%d0%b7%d0%be%d0%bd%d0%b0%d1%85/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Защищаемся от эксплоита nima salehi</title>
		<link>http://dedic.ru/%d0%b7%d0%b0%d1%89%d0%b8%d1%89%d0%b0%d0%b5%d0%bc%d1%81%d1%8f-%d0%be%d1%82-%d1%8d%d0%ba%d1%81%d0%bf%d0%bb%d0%be%d0%b8%d1%82%d0%b0-nima-salehi/</link>
					<comments>http://dedic.ru/%d0%b7%d0%b0%d1%89%d0%b8%d1%89%d0%b0%d0%b5%d0%bc%d1%81%d1%8f-%d0%be%d1%82-%d1%8d%d0%ba%d1%81%d0%bf%d0%bb%d0%be%d0%b8%d1%82%d0%b0-nima-salehi/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Thu, 26 Oct 2006 09:12:50 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d0%b7%d0%b0%d1%89%d0%b8%d1%89%d0%b0%d0%b5%d0%bc%d1%81%d1%8f-%d0%be%d1%82-%d1%8d%d0%ba%d1%81%d0%bf%d0%bb%d0%be%d0%b8%d1%82%d0%b0-nima-salehi/</guid>

					<description><![CDATA[<a href="http://www.securitylab.ru/poc/extra/275416.php">Новая версия эксплоита nima salehi позволяет получить рутовый доступ к серверам под управлением WHM</a>.
Для предотвращения есть минимум три варианта:

1. Самый простой - выполнить команду: touch /tmp/strict.pm ; chmod 000 /tmp/strict.pm; chown root /tmp/strict.pm]]></description>
										<content:encoded><![CDATA[<p><a href="http://www.securitylab.ru/poc/extra/275416.php">Новая версия эксплоита nima salehi позволяет получить рутовый доступ к серверам под управлением WHM</a>.<br />
Для предотвращения есть минимум три варианта:</p>
<p>1. Самый простой &#8212; выполнить команду: touch /tmp/strict.pm ; chmod 000 /tmp/strict.pm; chown root /tmp/strict.pm<br />
2. Более приемлемый &#8212; запретить passthru() в php.ini<br />
3. Самый надежный &#8212; установить grsecurity ядро с опцией TPE для группы nobody</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d0%b7%d0%b0%d1%89%d0%b8%d1%89%d0%b0%d0%b5%d0%bc%d1%81%d1%8f-%d0%be%d1%82-%d1%8d%d0%ba%d1%81%d0%bf%d0%bb%d0%be%d0%b8%d1%82%d0%b0-nima-salehi/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>MySQL, кодировки и вопросики вместо русских букв</title>
		<link>http://dedic.ru/mysql-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d0%b8-%d0%b2%d0%be%d0%bf%d1%80%d0%be%d1%81%d0%b8%d0%ba%d0%b8-%d0%b2%d0%bc%d0%b5%d1%81%d1%82%d0%be-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8/</link>
					<comments>http://dedic.ru/mysql-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d0%b8-%d0%b2%d0%be%d0%bf%d1%80%d0%be%d1%81%d0%b8%d0%ba%d0%b8-%d0%b2%d0%bc%d0%b5%d1%81%d1%82%d0%be-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Fri, 13 Oct 2006 09:33:45 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/mysql-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d0%b8-%d0%b2%d0%be%d0%bf%d1%80%d0%be%d1%81%d0%b8%d0%ba%d0%b8-%d0%b2%d0%bc%d0%b5%d1%81%d1%82%d0%be-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8/</guid>

					<description><![CDATA[В предыдущей <a href=node/213>статье о русификации MySQL</a> было написано как заставить mysql корректно работать с кодировкой utf8.

Но как быть если предположим есть два сервера и на одном из них mysql в utf8 а на другом - в стандартной кодировке?

Для решения этой проблемы предлагаем два очень простых скрипта - первый создает дампы всех баз, за исключением системных, а второй - заменяет существующие базы с неправильной кодировкой на правильную. Скрипт предназначен прежде всего для WHM/cPanel но в принципе пойдет на любых серверах.
]]></description>
										<content:encoded><![CDATA[<p>В предыдущей <a href=node/213>статье о русификации MySQL</a> было написано как заставить mysql корректно работать с кодировкой utf8.</p>
<p>Но как быть если предположим есть два сервера и на одном из них mysql в utf8 а на другом &#8212; в стандартной кодировке?</p>
<p>Для решения этой проблемы предлагаем два очень простых скрипта &#8212; первый создает дампы всех баз, за исключением системных, а второй &#8212; заменяет существующие базы с неправильной кодировкой на правильную. Скрипт предназначен прежде всего для WHM/cPanel но в принципе пойдет на любых серверах.<br />
<!--break--><br />
Сначала создадим архив с дампами баз mysql с помощью первого скрипта:<br />
<code><br />
for i in `mysqlshow  | grep -v + | grep -v '|                 Databases                  |' | cut -d ' ' -f2 | grep -v horde| grep -v mysql | grep -v eximstats`; do mysqldump -f --compatible=mysql40 $i > $i.sql; done; tar czf dump1251.tgz *.sql; rm *.sql<br />
</code><br />
В результате будет создан файл dump1251.tgz &#8212; архив со всеми дампами sql в нормальной кодировке. Его необходимо перенести на другой сервер и восстановить с помощью второго скрипта:<br />
<code><br />
for i in `ls *.sql`;do  b=`basename $i .sql`;yes | mysqladmin drop $b; mysqladmin create $b; mysql --default-character-set=utf8 $b < $i  ; done; rm *.sql
</code><br />
После этого вместо вопросительных знаков появятся русские буквы.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/mysql-%d0%ba%d0%be%d0%b4%d0%b8%d1%80%d0%be%d0%b2%d0%ba%d0%b8-%d0%b8-%d0%b2%d0%be%d0%bf%d1%80%d0%be%d1%81%d0%b8%d0%ba%d0%b8-%d0%b2%d0%bc%d0%b5%d1%81%d1%82%d0%be-%d1%80%d1%83%d1%81%d1%81%d0%ba%d0%b8/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Технология повышения качества виртуального хостинга</title>
		<link>http://dedic.ru/%d1%82%d0%b5%d1%85%d0%bd%d0%be%d0%bb%d0%be%d0%b3%d0%b8%d1%8f-%d0%bf%d0%be%d0%b2%d1%8b%d1%88%d0%b5%d0%bd%d0%b8%d1%8f-%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b0-%d0%b2%d0%b8%d1%80%d1%82%d1%83/</link>
					<comments>http://dedic.ru/%d1%82%d0%b5%d1%85%d0%bd%d0%be%d0%bb%d0%be%d0%b3%d0%b8%d1%8f-%d0%bf%d0%be%d0%b2%d1%8b%d1%88%d0%b5%d0%bd%d0%b8%d1%8f-%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b0-%d0%b2%d0%b8%d1%80%d1%82%d1%83/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Fri, 23 Jun 2006 12:42:30 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d1%82%d0%b5%d1%85%d0%bd%d0%be%d0%bb%d0%be%d0%b3%d0%b8%d1%8f-%d0%bf%d0%be%d0%b2%d1%8b%d1%88%d0%b5%d0%bd%d0%b8%d1%8f-%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b0-%d0%b2%d0%b8%d1%80%d1%82%d1%83/</guid>

					<description><![CDATA[<strong>Как можно повысить качество виртуального хостинга при ограниченном бюджете</strong>

Прежде всего, необходимо выяснить, кому необходим качественный виртуальный хостинг и какие стороны делают его качественным именно для данной аудитории.]]></description>
										<content:encoded><![CDATA[<p><strong>Как можно повысить качество виртуального хостинга при ограниченном бюджете</strong></p>
<p>Прежде всего, необходимо выяснить, кому необходим качественный виртуальный хостинг и какие стороны делают его качественным именно для данной аудитории.</p>
<p>Для оценки требования к качеству хостинга удобнее всего воспользоваться оценкой потерь за простой сайта &#8212; сколько денег потеряет компания, если ее сайт по тем или иным причинам станет недоступным для пользователей. При этом такие компании не могут позволить себе использовать собственные дата-центры, или свои сервера и высокий бюджет отпугнут их.</p>
<p>Таким образом, аудитория будет находиться в диапазоне, где максимальная месячная цена за хостинг не будет превышать аренду выделенного сервера (X), а месячная сумма потерь за время недоступности сайта (Y) не должна превышать среднеарифметический месячный доход такой компании (Z).</p>
<p>Следовательно, аудитория расположена в диапазоне Z > Y < X.
Исходя из того, что средняя стоимость месячной оплаты за аренду среднего выделенного сервера составляет 150$, то, соответственно, и ежемесячный доход такой компании не может превышать 150$.

Что же это за компании, которым нужен сайт, но который им не приносит дохода? Вероятнее всего, это компании, у которых их основная масса клиентов пользуется сайтом не для совершения сделок, а, скорее, для справочной информации.
Хорошим примером тут могут стать разнообразные интернет-магазины достаточно дорогих товаров. Посетители, просмотрев сайт и изучив все достоинства и недостатки, уже будут знать, что именно им предстоит купить и какую сумму потратить, пойдут в офис или филиал этого интернет-магазина, дабы вживую ощутить реальность выбранного товара.

Таким образом, этот потенциальный сайт служит информационно-справочным прейскурантом на продукцию с краткими характеристиками и изображениями достаточно дорогих товаров.

Каким образом можно повысить качество, а именно, время доступности сайта в сети (аптайм)?

Прежде всего, надо разобраться с технологиями, которыми оперирует пользователь хостинга и какие технологии служат для выдачи информации посетителям.

Пользователю необходимо иметь некую точку доступа (ТД), куда он будет с помощью доступных для этой задачи протоколов (ftp,scp, и т.п) помещать информацию на сервер.

Сам сервер, как точка выдачи (ТВ), обрабатывает эту информацию и отдает ее по протоколу http посетителям.

Также следует учесть, что накладные расходы в случае использования клиентом различных скриптов и баз данных будут достаточно высоки и, учитывая специфику таких сайтов, лучше конвертировать информацию в статические файлы с определенной дискретностью - раз в сутки, например.

Это означает, что появляются две различные сущности - точка доступа для пользователя хостинга (это работа с базами данных, с CMS и т.п.) и точка выдачи информации посетителям, которая должна отдать результат обработки сервером, скриптами и базой данных всей информации в виде веб-страницы.

Для повышения надежности прежде всего надо позаботиться о ТВ - их можно и нужно сделать несколькими по отношению к ТД. Наиболее простой и часто используемый вариант - это запуск веб-сервера на одном физическом сервере и выдача его через прокси-сервера, размещенных на других ресурсах.

Этот вариант не требует никаких дополнительных ухищрений - сайт работает, изменения отображаются с дискретностью, задаваемой директивами веб-сервера и прокси, а отказоустойчивость можно повышать за счет прокси-серверов: больше прокси - больше надежности. Однако тут есть и недостаток - это повышенная нагрузка к ТД. Чем больше прокси, тем чаще идут запросы к веб-серверу, и, в конце концов, он "захлебывается".

Самым логичным и правильным решением этой проблемы будет добавление новых ТД и синхронизация информации между ними. Даже если одна ТД будет недоступна, пользователь сможет работать с другой ТД.

Однако вариант с наращиванием ТД будет не самым лучшим решением, так как придется либо постоянно синхронизировать информацию между ТД, либо использовать общую сетевую файловую систему.

Другим вариантом является создание системы, переводящей весь сайт в статику и выдающей эту статику с помощью легкого веб-сервера. Наиболее удобными по соотношению цена/качество для этого решения станут виртуальные выделенные сервера, расположенные на серверах в различных дата-центрах.

Задача каждой такой ТВ будет периодическое создание полной копии (зеркала) сайта с ТД на диск и отдача его с помощью легкого веб-сервера, например, nginx. Как это сделать, было описано ранее.

В таком случае нагрузка на ТД падает на порядок - вместо тысяч запросов от посетителей получается по одному запросу от каждой ТВ.

В свою очередь, это снижает требования к ресурсам ТД - ее также можно разместить на VDS.

Так можно создать отказоустойчивую и быстродействующую систему.

Естественно, что тут есть ряд недостатков. Например, такая технология абсолютно не подходит для сайтов, которые имеют множество страниц и часто обновляемое содержание: форумы, доски объявлений и т.п.

</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d1%82%d0%b5%d1%85%d0%bd%d0%be%d0%bb%d0%be%d0%b3%d0%b8%d1%8f-%d0%bf%d0%be%d0%b2%d1%8b%d1%88%d0%b5%d0%bd%d0%b8%d1%8f-%d0%ba%d0%b0%d1%87%d0%b5%d1%81%d1%82%d0%b2%d0%b0-%d0%b2%d0%b8%d1%80%d1%82%d1%83/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Используем qemu для создания qVDS</title>
		<link>http://dedic.ru/%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d1%83%d0%b5%d0%bc-qemu-%d0%b4%d0%bb%d1%8f-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f-qvds/</link>
					<comments>http://dedic.ru/%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d1%83%d0%b5%d0%bc-qemu-%d0%b4%d0%bb%d1%8f-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f-qvds/#respond</comments>
		
		<dc:creator><![CDATA[dedic]]></dc:creator>
		<pubDate>Sat, 10 Jun 2006 08:53:41 +0000</pubDate>
				<category><![CDATA[Наследие]]></category>
		<guid isPermaLink="false">http://dedic.ru/%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d1%83%d0%b5%d0%bc-qemu-%d0%b4%d0%bb%d1%8f-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f-qvds/</guid>

					<description><![CDATA[Многим хотелось бы иметь на своем сервере возможность для экспериментов без риска или установить другую операционную систему. Конечно, такие технологии существуют уже достаточно давно - VDS, когда на основе одного физического сервера создаются несколько виртуальных.
Однако существует недостаток - необходимо пересобрать ядро с разного рода патчами, что очень рискованно - сервер может не загрузиться с новым ядром.
Для решения этой проблемы мы воспользовались <a href="http://www.qemu.com/">qemu</a> - открытой системой эмуляции как на уровне "железа", так и на UML (только для Linux, естественно).
Однако основным существенным преимуществом на практике является то, установка qemu чрезвычайно проста и не требует пересборки ядра, достаточно распаковать бинарный архив, добавить недостающие библиотеки и qemu готов к работе.
]]></description>
										<content:encoded><![CDATA[<p>Многим хотелось бы иметь на своем сервере возможность для экспериментов без риска или установить другую операционную систему. Конечно, такие технологии существуют уже достаточно давно &#8212; VDS, когда на основе одного физического сервера создаются несколько виртуальных.<br />
Однако существует недостаток &#8212; необходимо пересобрать ядро с разного рода патчами, что очень рискованно &#8212; сервер может не загрузиться с новым ядром.<br />
Для решения этой проблемы мы воспользовались <a href="http://www.qemu.com/">qemu</a> &#8212; открытой системой эмуляции как на уровне &#171;железа&#187;, так и на UML (только для Linux, естественно).<br />
Однако основным существенным преимуществом на практике является то, установка qemu чрезвычайно проста и не требует пересборки ядра, достаточно распаковать бинарный архив, добавить недостающие библиотеки и qemu готов к работе.<br />
<!--break--><br />
В то же время существуют два серьезных недостатка. Первый &#8212; это чрезмерное потребление ресурсов в эмуляции на уровне полной системы, что не позволяет конкурировать на данном уровне с такими технологиями, как OpenVZ, а второй &#8212; эмулятор использует GUI, что делает работу с ним чрезвычайно неудобной, особенно, если у Вас к серверу слабый канал.<br />
Но есть возможность избежать этого, запустив qemu в режиме терминала. Мы подготовили два образа: один &#8212; мини-образ Linux Debian в состоянии режима basic setup, второй &#8212; уже предустановленную FreeBSD с предусмотрительно поднятым ssh-сервером. Пароли также предустановлены &#8212; для admin &#8212; admin и для root &#8212; root. Обязательно смените их сразу после запуска. Скачать архивы с образами и скриптами можно по ftp &#8212; ftp://dedic.ru/qemu/, а можно выполнить самостоятельно.</p>
<p>Для дистрибутивов Linux необходимо скачать ISO-образ дистрибутива, и лучше всего, если это будет mini-образ, остальное можно ставить по сети. Затем этот образ монтируем во временную директорию (опция loop) и забираем оттуда само ядро vmlinuz и initrd.img. Запускаем qemu с этим ядром и inird, а в дополнительных опциях передаем вывод на консоль. После запуска qemu мы работаем с виртуальным сервером через консоль. Естественно, что графический инсталлятор лучше не использовать.</p>
<p>В случае же с FreeBSD все еще проще &#8212; достаточно включить в конфигурации comconsole и настроить ее, после чего перенаправить ввод-вывод в stdin/stdout.</p>
<p>Для доступа с виртуального сервера в сеть на настоящем сервере необходимо включить форвардинг:<br />
echo 1 > /proc/sys/net/ipv4/ip_forward<br />
и разрещить выход с подсетки 127.20.0.2 (это IP-диапазон виртуальных серверов):<br />
iptables -t nat -A POSTROUTING -s 172.20.0.0/24 -d 0/0 -j MASQUERADE<br />
Для того, чтобы виртуальный сервер был доступен под одним из реальных IP реального сервера, необходим обратный проброс:<br />
iptables -A FORWARD -d 172.20.0.2 -i eth0 -j ACCEPT<br />
iptables -t nat -A PREROUTING -d реальный.ip.тут -p tcp -j DNAT &#8212;to-destination 172.20.0.2</p>
]]></content:encoded>
					
					<wfw:commentRss>http://dedic.ru/%d0%b8%d1%81%d0%bf%d0%be%d0%bb%d1%8c%d0%b7%d1%83%d0%b5%d0%bc-qemu-%d0%b4%d0%bb%d1%8f-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d0%bd%d0%b8%d1%8f-qvds/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
	</channel>
</rss>
